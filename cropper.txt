// ======================================================================
/*!

\mainpage Cropper

\section cropper_intro Johdanto

Animaatioiden tekemisess‰ tarvitaan kuvien croppausta lennosta.  T‰h‰n
tarkoitukseen voisi k‰ytt‰‰ ImageMagick paketin \c convert k‰sky‰,
mutta ImageMagick on todettu turhan ep‰stabiiliksi. N‰in ollen
k‰yt‰mme lokaalia varta vasten t‰h‰n tarkoitukseen tehty‰ ohjelmaa.

Lis‰hyˆtyn‰ on mahdollisuus s‰‰t‰‰ tarkasti cropperin toimintaa,
esim.

  -# cachettaa tuloksia automaattisesti
  -# cropata keskipisteen suhteen kulmapisteen sijaan
  -# hyˆdynt‰‰ paikkatietokantaa

\section cropper_optiot Komentorivioptiot

<p>
Komentorivioptiot ovat
<dl>
<dt>-f [kuvatiedosto]</dt>
<dd>Kuvatiedoston nimi</dd>
<dt>-g [kulmageometria]</dt>
<dd>Cropattavan alueen koko ja kulmapiste.
<dt>-c [keskigeometria]</dt>
<dd>Cropattavan alueen koko ja keskipiste.
<dt>-p [nimigeometria]</dt>
<dd>Cropattavan alueen koko ja keskipisteen ja kartan nimi.
<dt>-l [latlongeometria]</dt>
<dd>Cropattavan alueen koko, keskipisteen koordinaatit ja kartan nimi.
<dt>-o [tiedostonimi]</dt>
<dd>Optionaalinen tiedostonimi</dd>
</dl>
</p>

<p>
Jos yht‰k‰‰n optioiosta -g, -c, -p tai -l ei ole annettu, palautetaan
haluttu kuva sellaisenaan.
</p>

<p>
Jos tiedostonimiargumenttia ei ole annettu, tulostetaan kuva aina
suoraan terminaalille sopivien HTTP-headerien kera. Kuvat oletetaan
staattisiksi (eli k‰yt‰nnˆss‰ nimiss‰ lienee aikaleima kuvien
erottelemiseksi). N‰in ollen kuvien ilmoitetaan olevan aina voimassa,
ne eiv‰t koskaan muutu eiv‰tk‰ ekspiroidu.
</p>

\section cropper_querystring QUERYSTRING optiot

<p>
Jos ymp‰ristˆmuuttuja \c QUERYSTRING on asetettu, oletetaan
ohjelmaa ajettavan cgi-bin‰‰rin‰, ja optiot parseroidaan
komentorivin sijaan \c QUERYSTRING muuttujasta.
</p>
<p>
Koko \c QUERYSTRING oletetaan cryptatuksi php:n palcrypt k‰skyll‰!
</p>
<p>
\c QUERYSTRING muuttujasta tunnistetaan komentorivioptioita
vastaavat muuttujat, eli f, g, c, p ja l, mutta ei optiota o.
Ylim‰‰r‰iset muuttujat j‰tet‰‰n huomioimatta ilman virheilmoitusta.
</p>

\section cropper_kulmat Croppaus kulmapisteiden suhteen

Optiolle \c -g annettavan \c [kulmageometria] argumentin syntaksi on
\code
<width>x<height>+<x1>+<y1>
\endcode
Cropattava alue on t‰llˆin

  - Vasen yl‰kulma: (x1,y1)
  - Oikea alakulma: (x2,y2) = (x1,y1) + (width,height)

\section cropper_keskipiste Croppaus keskipisteen suhteen

Optiolle \c -c annettavan \c [keskigeometria] argumentin syntaksi on
\code
<width>x<height>+<xc>+<yc>
\endcode
miss‰ (xc,yc) on haluttu keskipiste. Cropattavan alue on t‰llˆin

  - Vasen yl‰kulma (x1,y1) = (xc-width/2,yc-width/2)
  - Oikea alakulma (x2,y2) = (x1,y1) + (width,height)

\section cropper_nimetty Croppaus koordinaattitpisteen suhteen

Optiolle \c -l annettavan \c [latlongeometria] argumentin syntaksi on
\code
<width>x<height>+<lon>+<lat>:<karttanimi>
\endcode
Keskipisteen koordinaatti m‰‰r‰ytyy suoraan annettujen longitudin,
latitudin perusteella ja karttanimen perusteella. T‰m‰n j‰lkeen
cropattava alue m‰‰r‰ytyy kuten kappaleessa \ref cropper_keskipiste

\section cropper_nimetty Croppaus nimetyn pisteen suhteen

Optiolle \c -p annettavan \c [nimigeometria] argumentin syntaksi on
\code
<width>x<height>+<paikannimi>:<karttanimi>
\endcode
Keskipisteen koordinaatti lasketaan tietokannasta haettavan paikannimen
ja karttanimen perusteella. T‰m‰n j‰lkeen cropattava alue m‰‰r‰ytyy
kuten kappaleessa \ref cropper_keskipiste

\section cropper_kartat Tietokantam‰‰rittelyt

Tietokannat on toistaiseksi toteutettu tiedostopohjaisina.
Paikkakuntien nimet on tallennettu tiedostoon
\code
/data/share/coordinates/kaikki.txt
\endcode
Jos kartan nimi on \c tyyli/alue haetaan kartan m‰‰rittelyt
tiedostosta
\code
/data/share/maps/tyyli/alue/alue.cnf
\endcode

\section cropper_kuvaformaatit Kuvaformaatit

Toistaiseksi tuetaan vain PNG-kuvaformaattia.

\section cropper_cache Cache

Toistaiseksi cachea ei ole toteutettu. Cache toteutetaan vasta tarvittaessa.

*/
// ======================================================================
